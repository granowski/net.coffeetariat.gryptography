<html>
<head>
    <title>{{ apiTitleAndVersion }}</title>
    <link href="/www/index.css" rel="stylesheet" />
</head>
<body>
<section>
<h1>{{ apiTitleAndVersion }}</h1>
</section>

{% if trackingPrivateKeys == "true" %}
<section class="banner warning">
  <span>WARNING! The API server instance is tracking private keys for demonstration purposes! Do not use keys for security.</span>
</section>
{% endif %}

<section class="endpoints">
  <h2>Supported endpoints</h2>
  <ul class="endpoint-list">
    <li><span class="method">GET</span> <code>/health</code> — Health check</li>
    <li><span class="method">GET</span> <code>/api/clients/{clientId}/public-key</code> — Returns the client's public key (PEM)</li>
    <li><span class="method">GET</span> <code>/api/clients/{clientId}/new-private-key</code> — Generates a new key pair, stores public key, returns the private key (PEM)</li>
    <li><span class="method">GET</span> <code>/api/challenge?clientId={clientId}</code> — Returns a challenge in JSON (default) or YAML depending on <code>Accept</code> header</li>
    <li><span class="method">POST</span> <code>/api/answer?clientId={clientId}</code> — Verify challenge answer and issue JWT. Body: <code>application/x-www-form-urlencoded</code> with fields <code>sessionId</code> and <code>answer</code> (Base64). Returns JSON token.</li>
  </ul>

</section>

<section class="sample-interaction">
  <h2>Sample Interaction In cURLs</h2>
  <ul>
    <li>curl http://localhost:8080/api/clients/your-client-id/new-private-key</li>
    <li>curl 'http://localhost:8080/api/challenge?clientId=your-client-id' -X 'GET'</li>
    <li>curl -d "answer=signed-answer-goes-here&sessionId=session-from-challenge-request" "http://localhost:8080/api/answer?clientId=your-client-id"
  </ul>
</section>

<section><p>Count of clients is {{ countOfClients }}</p></section>

<section>
{% for client in clientsAndPublicKeys %}
  <div><span class="id">{{ client.key }}</span><span class="public-key">{{ client.value }}</span></div>
{% endfor %}
</section>

</body>
</html>